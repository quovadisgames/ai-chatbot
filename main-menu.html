<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDT AI - Main Menu</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ===== SHARED VARIABLES ===== */
        :root {
            /* PDT AI Brand Colors */
            --pdt-accent: #00A1D6;
            --pdt-accent-rgb: 0, 161, 214;
            --pdt-dark: #0D0D0D;
            --pdt-light: #E0E1DD;
            
            /* KOTOR Theme Variables */
            --kotor-bg: #1A2526;
            --kotor-dark: #0F1419;
            --kotor-accent: #00BFFF;
            --kotor-accent-rgb: 0, 191, 255;
            --kotor-warning: #FF4500;
            --kotor-success: #32CD32;
            --kotor-text: #FFFFFF;
            --kotor-text-secondary: rgba(255, 255, 255, 0.7);
            --kotor-border: rgba(0, 191, 255, 0.5);
            --kotor-glow: rgba(0, 191, 255, 0.3);
            --kotor-font: 'Exo 2', monospace;
            
            /* Jedi Survivor Theme Variables */
            --jedi-bg: #000000;
            --jedi-dark: #0D0D0D;
            --jedi-accent: #00D4FF;
            --jedi-accent-rgb: 0, 212, 255;
            --jedi-secondary: #8A8D93;
            --jedi-highlight: #A7C7E7;
            --jedi-warning: #FF4500;
            --jedi-success: #32CD32;
            --jedi-text: #FFFFFF;
            --jedi-text-secondary: #8A8D93;
            --jedi-border: rgba(255, 255, 255, 0.15);
            --jedi-glow: rgba(167, 199, 231, 0.3);
            --jedi-font: 'Rajdhani', sans-serif;
            --jedi-accent2: #FFB703;
            
            /* Professional Theme Variables */
            --prof-bg: #2E2E2E;
            --prof-dark: #1E1E1E;
            --prof-accent: #0078D4;
            --prof-accent-rgb: 0, 120, 212;
            --prof-warning: #FF4500;
            --prof-success: #32CD32;
            --prof-text: #F5F5F5;
            --prof-text-secondary: rgba(245, 245, 245, 0.7);
            --prof-border: rgba(0, 120, 212, 0.5);
            --prof-glow: rgba(0, 120, 212, 0.3);
            --prof-font: 'Inter', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--pdt-dark);
            color: var(--pdt-light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ===== MAIN MENU STYLES ===== */
        
        /* Main Container */
        .main-container {
            min-height: 100vh;
            background: radial-gradient(circle at center, var(--current-bg, #1B263B) 0%, #0D0D0D 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
            position: relative;
            overflow: hidden;
            animation: fadeIn 1s ease-in-out;
        }

        /* Neural Network Grid Background */
        .neural-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.4;
            background-image: 
                linear-gradient(to right, rgba(var(--current-accent-rgb, 0, 161, 214), 0.07) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(var(--current-accent-rgb, 0, 161, 214), 0.07) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: 0;
            animation: pulseGrid 5s infinite ease-in-out;
        }

        .neural-node {
            position: absolute;
            width: 5px;
            height: 5px;
            background-color: rgba(var(--current-accent-rgb, 0, 161, 214), 0.5);
            border-radius: 50%;
            z-index: 0;
            box-shadow: 0 0 4px rgba(var(--current-accent-rgb, 0, 161, 214), 0.3);
        }

        .neural-connection {
            position: absolute;
            height: 0.75px;
            background-color: rgba(var(--current-accent-rgb, 0, 161, 214), 0.2);
            transform-origin: left center;
            z-index: 0;
        }

        /* Particles */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 1;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            background-color: #E0E1DD;
            width: 2px;
            height: 2px;
            border-radius: 50%;
            opacity: 0.15;
            animation: particleDrift var(--drift-duration, 3s) infinite linear;
            box-shadow: 0 0 6px rgba(var(--current-accent-rgb, 0, 161, 214), 0.6);
        }

        /* Waves Effect */
        .waves-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 300px;
            overflow: hidden;
            z-index: 1;
            pointer-events: none;
        }

        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: rgba(var(--current-accent-rgb, 0, 161, 214), 0.05);
            border-radius: 50% 50% 0 0 / 100% 100% 0 0;
            transform-origin: bottom center;
        }

        .wave-1 {
            animation: wave 15s linear infinite;
            height: 90px;
            opacity: 1;
        }

        .wave-2 {
            animation: wave 10s linear infinite;
            height: 120px;
            opacity: 0.8;
            animation-delay: -5s;
        }

        .wave-3 {
            animation: wave 8s linear infinite;
            height: 150px;
            opacity: 0.5;
            animation-delay: -2s;
        }

        /* Main Menu Content */
        .menu-container {
            max-width: 800px;
            width: 100%;
            z-index: 2;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        .menu-title {
            font-family: var(--jedi-font, 'Rajdhani'), sans-serif;
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--jedi-text, #FFFFFF);
            text-shadow: 0 0 8px var(--jedi-accent, #00D4FF);
        }

        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            width: 100%;
            max-width: 400px;
            animation: slideIn 0.5s ease-in-out;
        }

        .menu-button {
            padding: 1rem;
            background: rgba(var(--pdt-accent-rgb, 0, 161, 214), 0.3);
            color: var(--jedi-text, #FFFFFF);
            border: 2px solid var(--pdt-accent, #00A1D6);
            border-radius: 8px;
            font-family: var(--jedi-font, 'Rajdhani'), sans-serif;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-align: center;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .menu-button:hover {
            background: rgba(var(--pdt-accent-rgb, 0, 161, 214), 0.5);
            box-shadow: 0 0 10px var(--pdt-accent, #00A1D6);
            transform: translateY(-2px);
        }

        .menu-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.1),
                transparent
            );
            transition: all 0.5s ease;
        }

        .menu-button:hover::before {
            left: 100%;
        }

        /* Chat Card */
        .chat-card {
            width: 100%;
            max-width: 400px;
            background: #1B263B;
            border: 2px solid var(--jedi-accent, #00D4FF);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1rem;
            cursor: pointer;
            transition: all 0.5s ease;
            transform-origin: center;
            animation: slideIn 0.5s ease-in-out;
            animation-delay: 0.2s;
            animation-fill-mode: both;
            position: relative;
            overflow: hidden;
        }

        .chat-card.expanded {
            max-width: 800px;
            height: 500px;
            cursor: default;
        }

        .chat-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .chat-card-title {
            font-family: var(--jedi-font, 'Rajdhani'), sans-serif;
            font-size: 20px;
            font-weight: 600;
            color: var(--jedi-accent, #00D4FF);
        }

        .chat-card-status {
            font-family: var(--jedi-font, 'Rajdhani'), sans-serif;
            font-size: 14px;
            color: var(--jedi-text-secondary, #8A8D93);
            background-color: rgba(0, 0, 0, 0.3);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
        }

        .chat-card-content {
            color: var(--pdt-light, #E0E1DD);
            font-family: var(--jedi-font, 'Rajdhani'), sans-serif;
            text-align: left;
            height: 0;
            overflow: hidden;
            transition: height 0.5s ease;
        }

        .chat-card.expanded .chat-card-content {
            height: 400px;
            overflow-y: auto;
        }

        .chat-message {
            margin-bottom: 1rem;
            padding: 0.75rem;
            border-radius: 8px;
            max-width: 80%;
        }

        .chat-message.ai {
            background-color: rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.1);
            border-left: 3px solid var(--jedi-accent, #00D4FF);
            align-self: flex-start;
        }

        .chat-message.user {
            background-color: rgba(var(--pdt-accent-rgb, 0, 161, 214), 0.1);
            border-right: 3px solid var(--pdt-accent, #00A1D6);
            align-self: flex-end;
            margin-left: auto;
        }

        /* Back to Home Link */
        .back-link {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 10;
            color: var(--jedi-text, #FFFFFF);
            text-decoration: none;
            font-family: var(--jedi-font, 'Rajdhani'), sans-serif;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--jedi-accent, #00D4FF);
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background-color: rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.2);
            box-shadow: 0 0 5px var(--jedi-accent, #00D4FF);
        }

        /* Theme Switcher */
        .theme-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
        }

        .theme-switcher-button {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--jedi-accent, #00D4FF);
            border-radius: 4px;
            color: var(--jedi-text, #FFFFFF);
            padding: 8px 12px;
            font-family: var(--jedi-font, 'Rajdhani'), sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .theme-switcher-button::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.2),
                transparent
            );
            transition: all 0.5s ease;
        }

        .theme-switcher-button:hover::after {
            left: 100%;
        }

        .theme-switcher-button:hover {
            background-color: rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.2);
            box-shadow: 0 0 10px rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.3);
        }

        .theme-switcher-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 180px;
            background-color: #1A1A1A;
            border: 1px solid var(--jedi-accent, #00D4FF);
            border-radius: 4px;
            margin-top: 4px;
            overflow: hidden;
            display: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .theme-switcher.active .theme-switcher-dropdown {
            display: block;
            animation: fadeIn 0.2s ease-in-out;
        }

        .theme-option {
            padding: 10px 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .theme-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.05),
                transparent
            );
            transition: all 0.5s ease;
        }

        .theme-option:hover::before {
            left: 100%;
        }

        .theme-option:hover {
            background-color: rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.2);
        }

        .theme-option[data-theme="kotor"]:hover {
            background-color: rgba(var(--kotor-accent-rgb, 0, 191, 255), 0.2);
        }

        .theme-option[data-theme="jedi"]:hover {
            background-color: rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.2);
        }

        .theme-option[data-theme="professional"]:hover {
            background-color: rgba(var(--prof-accent-rgb, 0, 120, 212), 0.2);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulseGrid {
            0% { opacity: 0.3; }
            50% { opacity: 0.5; }
            100% { opacity: 0.3; }
        }

        @keyframes particleDrift {
            0% {
                opacity: 0;
                transform: translateY(0) translateX(0) scale(0.8);
            }
            10% {
                opacity: 0.3;
                transform: translateY(var(--y-drift, 10px) * 0.1) translateX(var(--x-drift, 10px) * 0.1) scale(1);
            }
            90% {
                opacity: 0.3;
                transform: translateY(var(--y-drift, 90px) * 0.9) translateX(var(--x-drift, 90px) * 0.9) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(var(--y-drift, 100px)) translateX(var(--x-drift, 100px)) scale(0.8);
            }
        }

        @keyframes wave {
            0% {
                transform: scaleX(1) translateX(0);
            }
            50% {
                transform: scaleX(1.4) translateX(-15%);
            }
            100% {
                transform: scaleX(1) translateX(0);
            }
        }

        /* Theme-specific body classes */
        body.kotor-theme {
            --current-bg: var(--kotor-bg);
            --current-dark: var(--kotor-dark);
            --current-accent: var(--kotor-accent);
            --current-accent-rgb: var(--kotor-accent-rgb);
            --current-text: var(--kotor-text);
            --current-text-secondary: var(--kotor-text-secondary);
            --current-border: var(--kotor-border);
            --current-glow: var(--kotor-glow);
            --current-font: var(--kotor-font);
        }

        body.jedi-theme {
            --current-bg: var(--jedi-bg);
            --current-dark: var(--jedi-dark);
            --current-accent: var(--jedi-accent);
            --current-accent-rgb: var(--jedi-accent-rgb);
            --current-text: var(--jedi-text);
            --current-text-secondary: var(--jedi-text-secondary);
            --current-border: var(--jedi-border);
            --current-glow: var(--jedi-glow);
            --current-font: var(--jedi-font);
        }

        body.professional-theme {
            --current-bg: var(--prof-bg);
            --current-dark: var(--prof-dark);
            --current-accent: var(--prof-accent);
            --current-accent-rgb: var(--prof-accent-rgb);
            --current-text: var(--prof-text);
            --current-text-secondary: var(--prof-text-secondary);
            --current-border: var(--prof-border);
            --current-glow: var(--prof-glow);
            --current-font: var(--prof-font);
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .menu-container {
                max-width: 90%;
            }
            
            .chat-card.expanded {
                max-width: 90%;
            }
        }

        @media (max-width: 480px) {
            .menu-title {
                font-size: 28px;
            }
            
            .menu-button {
                padding: 0.75rem;
                font-size: 16px;
            }
            
            .back-link, .theme-switcher-button {
                padding: 6px 10px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body class="jedi-theme">
    <div class="main-container">
        <div class="neural-grid"></div>
        <div id="neural-nodes"></div>
        <div class="particles" id="particles"></div>
        <div class="waves-container" id="waves-container"></div>
        
        <a href="index.html" class="back-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
            Back to Home
        </a>
        
        <div class="theme-switcher">
            <button class="theme-switcher-button">
                <span class="current-theme">Jedi: Survivor</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </button>
            <div class="theme-switcher-dropdown">
                <div class="theme-option" data-theme="kotor">KOTOR</div>
                <div class="theme-option" data-theme="jedi">Jedi: Survivor</div>
                <div class="theme-option" data-theme="professional">Professional</div>
            </div>
        </div>
        
        <div class="menu-container">
            <h1 class="menu-title">PDT AI Command Center</h1>
            
            <div class="menu-buttons">
                <a href="persona-creation.html" class="menu-button">Create New Persona</a>
                <button class="menu-button" id="open-chat-btn">Open Chat</button>
            </div>
            
            <div class="chat-card" id="chat-card">
                <div class="chat-card-header">
                    <div class="chat-card-title">Mission: Support Query #1</div>
                    <div class="chat-card-status">Active</div>
                </div>
                <div class="chat-card-content">
                    <div class="chat-message ai">
                        Welcome, Commander. I've analyzed your request regarding the optimization of neural network parameters. Based on my calculations, I recommend adjusting the learning rate to 0.001 and implementing batch normalization between layers.
                    </div>
                    <div class="chat-message user">
                        Thanks for the analysis. Can you explain why batch normalization would help in this specific case?
                    </div>
                    <div class="chat-message ai">
                        Certainly. In your architecture, the deep layers are experiencing vanishing gradient issues. Batch normalization will stabilize the distribution of inputs to each layer, allowing for faster training and reducing the internal covariate shift. This is particularly important given the high dimensionality of your input data.
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize theme switcher
        initThemeSwitcher();
        
        // Create background effects
        createNeuralNetwork();
        createParticles();
        createWaves();
        
        // Initialize chat card
        initChatCard();
    });
    
    // Theme switcher functionality
    function initThemeSwitcher() {
        const savedTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
        setTheme(savedTheme);
        
        const themeSwitcher = document.querySelector('.theme-switcher');
        const themeButton = document.querySelector('.theme-switcher-button');
        const themeOptions = document.querySelectorAll('.theme-option');
        
        // Toggle dropdown
        themeButton.addEventListener('click', function() {
            themeSwitcher.classList.toggle('active');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            if (!themeSwitcher.contains(event.target)) {
                themeSwitcher.classList.remove('active');
            }
        });
        
        // Theme selection
        themeOptions.forEach(option => {
            option.addEventListener('click', function() {
                const theme = this.getAttribute('data-theme');
                setTheme(theme);
                themeSwitcher.classList.remove('active');
            });
        });
    }
    
    function setTheme(theme) {
        // Create transition overlay
        const overlay = document.createElement('div');
        overlay.style.position = 'fixed';
        overlay.style.top = '0';
        overlay.style.left = '0';
        overlay.style.width = '100%';
        overlay.style.height = '100%';
        overlay.style.backgroundColor = theme === 'kotor' ? '#00BFFF' : 
                                       theme === 'jedi' ? '#00D4FF' : '#0078D4';
        overlay.style.zIndex = '9999';
        overlay.style.transformOrigin = 'left';
        overlay.style.transform = 'scaleX(0)';
        overlay.style.opacity = '0';
        overlay.style.pointerEvents = 'none';
        document.body.appendChild(overlay);
        
        // Animate the overlay
        overlay.animate([
            { transform: 'scaleX(0)', opacity: 0.3 },
            { transform: 'scaleX(1)', opacity: 0.3 },
            { transform: 'scaleX(1)', opacity: 0 }
        ], {
            duration: 500,
            easing: 'ease-in-out'
        }).onfinish = function() {
            overlay.remove();
        };
        
        // Remove all theme classes
        document.body.classList.remove('kotor-theme', 'jedi-theme', 'professional-theme');
        
        // Add selected theme class
        document.body.classList.add(`${theme}-theme`);
        
        // Update current theme text
        document.querySelector('.current-theme').textContent = 
            theme === 'kotor' ? 'KOTOR' : 
            theme === 'jedi' ? 'Jedi: Survivor' : 
            'Professional';
        
        // Save to localStorage
        localStorage.setItem('pdtAiTheme', theme);
        
        // Update UI elements based on theme
        updateUIForTheme(theme);
        
        // Recreate background effects with theme-specific styling
        createParticles();
        updateNeuralNetworkColors(theme);
        updateWaveColors(theme);
    }
    
    function updateUIForTheme(theme) {
        // Update menu buttons
        const menuButtons = document.querySelectorAll('.menu-button');
        menuButtons.forEach(button => {
            if (theme === 'kotor') {
                button.style.border = '2px solid var(--kotor-accent)';
                button.style.fontFamily = 'var(--kotor-font)';
            } else if (theme === 'jedi') {
                button.style.border = '2px solid var(--jedi-accent)';
                button.style.fontFamily = 'var(--jedi-font)';
            } else {
                button.style.border = '2px solid var(--prof-accent)';
                button.style.fontFamily = 'var(--prof-font)';
            }
        });
        
        // Update chat card
        const chatCard = document.querySelector('.chat-card');
        const chatTitle = document.querySelector('.chat-card-title');
        const chatMessages = document.querySelectorAll('.chat-message');
        
        if (theme === 'kotor') {
            chatCard.style.border = '2px solid var(--kotor-accent)';
            chatTitle.style.color = 'var(--kotor-accent)';
            chatMessages.forEach(msg => {
                if (msg.classList.contains('ai')) {
                    msg.style.borderLeft = '3px solid var(--kotor-accent)';
                    msg.style.backgroundColor = 'rgba(var(--kotor-accent-rgb), 0.1)';
                }
            });
        } else if (theme === 'jedi') {
            chatCard.style.border = '2px solid var(--jedi-accent)';
            chatTitle.style.color = 'var(--jedi-accent)';
            chatMessages.forEach(msg => {
                if (msg.classList.contains('ai')) {
                    msg.style.borderLeft = '3px solid var(--jedi-accent)';
                    msg.style.backgroundColor = 'rgba(var(--jedi-accent-rgb), 0.1)';
                }
            });
        } else {
            chatCard.style.border = '2px solid var(--prof-accent)';
            chatTitle.style.color = 'var(--prof-accent)';
            chatMessages.forEach(msg => {
                if (msg.classList.contains('ai')) {
                    msg.style.borderLeft = '3px solid var(--prof-accent)';
                    msg.style.backgroundColor = 'rgba(var(--prof-accent-rgb), 0.1)';
                }
            });
        }
        
        // Update back link and theme switcher button styling
        const backLink = document.querySelector('.back-link');
        const themeButton = document.querySelector('.theme-switcher-button');
        const themeDropdown = document.querySelector('.theme-switcher-dropdown');
        
        if (theme === 'kotor') {
            backLink.style.border = '1px solid var(--kotor-accent)';
            themeButton.style.border = '1px solid var(--kotor-accent)';
            themeDropdown.style.border = '1px solid var(--kotor-accent)';
            document.querySelector('.menu-title').style.textShadow = '0 0 8px var(--kotor-accent)';
        } else if (theme === 'jedi') {
            backLink.style.border = '1px solid var(--jedi-accent)';
            themeButton.style.border = '1px solid var(--jedi-accent)';
            themeDropdown.style.border = '1px solid var(--jedi-accent)';
            document.querySelector('.menu-title').style.textShadow = '0 0 8px var(--jedi-accent)';
        } else {
            backLink.style.border = '1px solid var(--prof-accent)';
            themeButton.style.border = '1px solid var(--prof-accent)';
            themeDropdown.style.border = '1px solid var(--prof-accent)';
            document.querySelector('.menu-title').style.textShadow = '0 0 8px var(--prof-accent)';
        }
    }
    
    // Create neural network nodes and connections
    function createNeuralNetwork() {
        const nodesContainer = document.getElementById('neural-nodes');
        nodesContainer.innerHTML = '';
        const nodeCount = 13; // Reduced count as requested
        const nodes = [];
        
        // Create nodes
        for (let i = 0; i < nodeCount; i++) {
            const node = document.createElement('div');
            node.className = 'neural-node';
            
            // Random position
            const x = Math.random() * 100;
            const y = Math.random() * 100;
            node.style.left = `${x}%`;
            node.style.top = `${y}%`;
            
            nodes.push({
                element: node,
                x: x,
                y: y
            });
            
            nodesContainer.appendChild(node);
        }
        
        // Create connections between nodes
        for (let i = 0; i < nodeCount; i++) {
            const sourceNode = nodes[i];
            
            // Connect to 1-2 other nodes (reduced from 2-4)
            const connectionCount = Math.floor(Math.random() * 2) + 1;
            
            for (let j = 0; j < connectionCount; j++) {
                // Select a random target node
                const targetIndex = Math.floor(Math.random() * nodeCount);
                if (targetIndex !== i) {
                    const targetNode = nodes[targetIndex];
                    
                    const connection = document.createElement('div');
                    connection.className = 'neural-connection';
                    
                    // Position at source node
                    connection.style.left = `${sourceNode.x}%`;
                    connection.style.top = `${sourceNode.y}%`;
                    
                    // Calculate length and angle
                    const dx = targetNode.x - sourceNode.x;
                    const dy = targetNode.y - sourceNode.y;
                    const length = Math.sqrt(dx * dx + dy * dy);
                    const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                    
                    // Set width (length) and rotation
                    connection.style.width = `${length}%`;
                    connection.style.transform = `rotate(${angle}deg)`;
                    
                    nodesContainer.appendChild(connection);
                }
            }
        }
        
        // Update colors based on current theme
        const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
        updateNeuralNetworkColors(currentTheme);
    }
    
    // Update neural network colors based on theme
    function updateNeuralNetworkColors(theme) {
        const nodes = document.querySelectorAll('.neural-node');
        const connections = document.querySelectorAll('.neural-connection');
        
        let nodeColor, connectionColor, nodeShadow;
        
        if (theme === 'kotor') {
            nodeColor = 'rgba(var(--kotor-accent-rgb, 0, 191, 255), 0.5)';
            connectionColor = 'rgba(var(--kotor-accent-rgb, 0, 191, 255), 0.2)';
            nodeShadow = '0 0 4px rgba(var(--kotor-accent-rgb, 0, 191, 255), 0.3)';
        } else if (theme === 'jedi') {
            nodeColor = 'rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.5)';
            connectionColor = 'rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.2)';
            nodeShadow = '0 0 4px rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.3)';
        } else {
            nodeColor = 'rgba(var(--prof-accent-rgb, 0, 120, 212), 0.5)';
            connectionColor = 'rgba(var(--prof-accent-rgb, 0, 120, 212), 0.2)';
            nodeShadow = '0 0 4px rgba(var(--prof-accent-rgb, 0, 120, 212), 0.3)';
        }
        
        nodes.forEach(node => {
            node.style.backgroundColor = nodeColor;
            node.style.boxShadow = nodeShadow;
        });
        
        connections.forEach(connection => {
            connection.style.backgroundColor = connectionColor;
        });
    }
    
    // Create particles
    function createParticles() {
        const particlesContainer = document.getElementById('particles');
        particlesContainer.innerHTML = '';
        
        // Determine particle count and style based on theme
        let particleCount, particleColor, particleOpacity, particleSize, particleGlow;
        
        // Get current theme
        const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
        
        if (currentTheme === 'kotor') {
            particleCount = 35;
            particleColor = '#00BFFF';
            particleOpacity = 0.45;
            particleSize = 4;
            particleGlow = '0 0 8px #00BFFF';
        } else if (currentTheme === 'jedi') {
            particleCount = 30;
            particleColor = '#00D4FF';
            particleOpacity = 0.35;
            particleSize = 3.5;
            particleGlow = '0 0 7px #00D4FF';
        } else if (currentTheme === 'professional') {
            particleCount = 25;
            particleColor = '#0078D4';
            particleOpacity = 0.28;
            particleSize = 2.5;
            particleGlow = '0 0 5px #0078D4';
        }
        
        for (let i = 0; i < particleCount; i++) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            
            // Apply theme-specific styling
            particle.style.backgroundColor = particleColor;
            particle.style.opacity = particleOpacity;
            particle.style.width = `${particleSize}px`;
            particle.style.height = `${particleSize}px`;
            particle.style.boxShadow = particleGlow;
            
            // Random position
            const x = Math.random() * 100;
            const y = Math.random() * 100;
            particle.style.left = `${x}%`;
            particle.style.top = `${y}%`;
            
            // Random drift direction and speed
            const xDrift = (Math.random() - 0.5) * 400;
            const yDrift = (Math.random() - 0.5) * 400;
            particle.style.setProperty('--x-drift', `${xDrift}px`);
            particle.style.setProperty('--y-drift', `${yDrift}px`);
            
            // Random animation duration
            const duration = 2 + Math.random() * 5;
            particle.style.setProperty('--drift-duration', `${duration}s`);
            
            // Random delay
            const delay = Math.random() * 5;
            particle.style.animationDelay = `${delay}s`;
            
            particlesContainer.appendChild(particle);
        }
    }
    
    // Create waves
    function createWaves() {
        const wavesContainer = document.getElementById('waves-container');
        wavesContainer.innerHTML = '';
        
        // Create 3 wave layers
        for (let i = 0; i < 3; i++) {
            const wave = document.createElement('div');
            wave.className = `wave wave-${i+1}`;
            wavesContainer.appendChild(wave);
        }
        
        // Update wave colors based on theme
        const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
        updateWaveColors(currentTheme);
    }
    
    // Update wave colors based on theme
    function updateWaveColors(theme) {
        const waves = document.querySelectorAll('.wave');
        let waveColor;
        
        if (theme === 'kotor') {
            waveColor = 'rgba(var(--kotor-accent-rgb, 0, 191, 255), ';
        } else if (theme === 'jedi') {
            waveColor = 'rgba(var(--jedi-accent-rgb, 0, 212, 255), ';
        } else {
            waveColor = 'rgba(var(--prof-accent-rgb, 0, 120, 212), ';
        }
        
        waves.forEach((wave, index) => {
            const opacity = 0.09 - (index * 0.015);
            wave.style.background = `${waveColor}${opacity})`;
        });
    }
    
    // Initialize chat card functionality
    function initChatCard() {
        const chatCard = document.getElementById('chat-card');
        const openChatBtn = document.getElementById('open-chat-btn');
        
        // Toggle chat card expansion on click
        chatCard.addEventListener('click', function() {
            if (!this.classList.contains('expanded')) {
                expandChatCard();
            }
        });
        
        // Open chat button functionality
        openChatBtn.addEventListener('click', function() {
            expandChatCard();
            // For future implementation: 
            // Uncomment the line below to navigate to a dedicated chat page instead of expanding the chat card
            // window.location.href = 'chat.html';
        });
        
        // Add close button to chat card
        const closeButton = document.createElement('button');
        closeButton.innerHTML = 'Ã—';
        closeButton.style.position = 'absolute';
        closeButton.style.top = '10px';
        closeButton.style.right = '10px';
        closeButton.style.background = 'none';
        closeButton.style.border = 'none';
        closeButton.style.color = 'var(--pdt-light)';
        closeButton.style.fontSize = '24px';
        closeButton.style.cursor = 'pointer';
        closeButton.style.display = 'none';
        closeButton.style.zIndex = '5';
        
        chatCard.appendChild(closeButton);
        
        // Close button functionality
        closeButton.addEventListener('click', function(event) {
            event.stopPropagation();
            collapseChatCard();
        });
        
        function expandChatCard() {
            chatCard.classList.add('expanded');
            closeButton.style.display = 'block';
            
            // Add chat input when expanded
            if (!document.getElementById('chat-input-container')) {
                const inputContainer = document.createElement('div');
                inputContainer.id = 'chat-input-container';
                inputContainer.style.display = 'flex';
                inputContainer.style.marginTop = '1rem';
                inputContainer.style.position = 'absolute';
                inputContainer.style.bottom = '1rem';
                inputContainer.style.left = '1rem';
                inputContainer.style.right = '1rem';
                
                const chatInput = document.createElement('input');
                chatInput.type = 'text';
                chatInput.placeholder = 'Type your message...';
                chatInput.style.flex = '1';
                chatInput.style.padding = '0.75rem';
                chatInput.style.backgroundColor = 'rgba(0, 0, 0, 0.3)';
                chatInput.style.border = '1px solid rgba(255, 255, 255, 0.1)';
                chatInput.style.borderRadius = '4px';
                chatInput.style.color = 'var(--pdt-light)';
                chatInput.style.fontFamily = 'var(--current-font)';
                
                const sendButton = document.createElement('button');
                sendButton.innerHTML = 'Send';
                sendButton.style.marginLeft = '0.5rem';
                sendButton.style.padding = '0.75rem 1rem';
                sendButton.style.backgroundColor = 'rgba(var(--current-accent-rgb), 0.3)';
                sendButton.style.border = '1px solid var(--current-accent)';
                sendButton.style.borderRadius = '4px';
                sendButton.style.color = 'var(--pdt-light)';
                sendButton.style.fontFamily = 'var(--current-font)';
                sendButton.style.cursor = 'pointer';
                
                inputContainer.appendChild(chatInput);
                inputContainer.appendChild(sendButton);
                chatCard.appendChild(inputContainer);
                
                // Send message functionality
                sendButton.addEventListener('click', sendMessage);
                chatInput.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') {
                        sendMessage();
                    }
                });
                
                function sendMessage() {
                    const messageText = chatInput.value.trim();
                    if (messageText) {
                        // Create user message
                        const userMessage = document.createElement('div');
                        userMessage.className = 'chat-message user';
                        userMessage.textContent = messageText;
                        
                        // Add to chat content
                        const chatContent = document.querySelector('.chat-card-content');
                        chatContent.appendChild(userMessage);
                        
                        // Clear input
                        chatInput.value = '';
                        
                        // Scroll to bottom
                        chatContent.scrollTop = chatContent.scrollHeight;
                        
                        // Simulate AI response after a delay
                        setTimeout(function() {
                            const aiMessage = document.createElement('div');
                            aiMessage.className = 'chat-message ai';
                            aiMessage.textContent = getAIResponse();
                            
                            chatContent.appendChild(aiMessage);
                            chatContent.scrollTop = chatContent.scrollHeight;
                        }, 1000);
                    }
                }
                
                // Simple AI response generator
                function getAIResponse() {
                    const responses = [
                        "I've analyzed your request and have prepared a detailed report on the findings.",
                        "Based on my calculations, the optimal approach would be to implement a hybrid algorithm that combines both methods.",
                        "Your hypothesis is interesting. My simulations suggest a 78% probability of success with the parameters you've specified.",
                        "I've detected a potential anomaly in the data pattern. Would you like me to investigate further?",
                        "The neural network architecture you've proposed shows promise, but I recommend adjusting the hidden layer configuration for better performance."
                    ];
                    
                    return responses[Math.floor(Math.random() * responses.length)];
                }
            }
        }
        
        function collapseChatCard() {
            chatCard.classList.remove('expanded');
            closeButton.style.display = 'none';
            
            // Remove chat input when collapsed
            const inputContainer = document.getElementById('chat-input-container');
            if (inputContainer) {
                inputContainer.remove();
            }
        }
    }
</script>
</html> 