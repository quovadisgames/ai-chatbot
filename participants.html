<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDT AI - Manage Participants</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700&family=Inter:wght@300;400;500;600;700&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Main stylesheet -->
    <link rel="stylesheet" href="styles.css">
    <!-- Theme stylesheets -->
    <link rel="stylesheet" href="themes/kotor.css">
    <link rel="stylesheet" href="themes/jedi.css">
    <link rel="stylesheet" href="themes/professional.css">
    <!-- Page-specific styles -->
    <link rel="stylesheet" href="styles/participants.css">
    <style>
        /* Fix for vertical scrolling */
        html, body {
            overflow-x: hidden;
        }
        
        .main-container {
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            overflow-y: auto;
        }
        
        .neural-grid, 
        #neural-nodes, 
        .particles, 
        .waves-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
    </style>
</head>
<body class="jedi-theme">
    <div class="main-container">
        <div class="neural-grid"></div>
        <div id="neural-nodes"></div>
        <div class="particles" id="particles"></div>
        <div class="waves-container" id="waves-container"></div>
        
        <a href="chat.html" class="back-link">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
            Back to Chat
        </a>
        
        <div class="theme-switcher">
            <button class="theme-switcher-button">
                <span class="current-theme">Jedi: Survivor</span>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
            </button>
            <div class="theme-switcher-dropdown">
                <div class="theme-option" data-theme="kotor">KOTOR</div>
                <div class="theme-option" data-theme="jedi">Jedi: Survivor</div>
                <div class="theme-option" data-theme="professional">Professional</div>
            </div>
        </div>
        
        <div class="participants-container">
            <h1 class="section-title">Manage Participants</h1>
            <p class="section-description">Add or remove participants from your current chat session.</p>
            
            <div class="participants-content">
                <div class="current-participants">
                    <h2 class="subsection-title">Current Participants</h2>
                    <div class="participants-list">
                        <!-- Current participants will be populated here -->
                        <div class="participant-item">
                            <div class="participant-avatar">
                                <img src="https://via.placeholder.com/40" alt="User Avatar">
                            </div>
                            <div class="participant-info">
                                <div class="participant-name">You (Host)</div>
                                <div class="participant-status">Online</div>
                            </div>
                            <div class="participant-actions">
                                <button class="action-button" disabled>Remove</button>
                            </div>
                        </div>
                        
                        <div class="participant-item">
                            <div class="participant-avatar ai-avatar">
                                <div class="avatar-icon">AI</div>
                            </div>
                            <div class="participant-info">
                                <div class="participant-name">PDT AI Assistant</div>
                                <div class="participant-status">Active</div>
                            </div>
                            <div class="participant-actions">
                                <button class="action-button" disabled>Remove</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="available-participants">
                    <h2 class="subsection-title">Available Participants</h2>
                    <div class="search-bar">
                        <input type="text" placeholder="Search participants..." id="participant-search">
                        <button class="search-button">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
                        </button>
                    </div>
                    
                    <div class="participants-list available-list">
                        <!-- Available participants will be populated here -->
                        <div class="participant-item">
                            <div class="participant-avatar">
                                <img src="https://via.placeholder.com/40?text=JD" alt="John Doe Avatar">
                            </div>
                            <div class="participant-info">
                                <div class="participant-name">John Doe</div>
                                <div class="participant-status">Available</div>
                            </div>
                            <div class="participant-actions">
                                <button class="action-button add-button">Add</button>
                            </div>
                        </div>
                        
                        <div class="participant-item">
                            <div class="participant-avatar">
                                <img src="https://via.placeholder.com/40?text=JS" alt="Jane Smith Avatar">
                            </div>
                            <div class="participant-info">
                                <div class="participant-name">Jane Smith</div>
                                <div class="participant-status">Available</div>
                            </div>
                            <div class="participant-actions">
                                <button class="action-button add-button">Add</button>
                            </div>
                        </div>
                        
                        <div class="participant-item">
                            <div class="participant-avatar">
                                <img src="https://via.placeholder.com/40?text=RJ" alt="Robert Johnson Avatar">
                            </div>
                            <div class="participant-info">
                                <div class="participant-name">Robert Johnson</div>
                                <div class="participant-status">Available</div>
                            </div>
                            <div class="participant-actions">
                                <button class="action-button add-button">Add</button>
                            </div>
                        </div>
                        
                        <div class="participant-item">
                            <div class="participant-avatar ai-avatar specialized">
                                <div class="avatar-icon">AI+</div>
                            </div>
                            <div class="participant-info">
                                <div class="participant-name">Technical Specialist AI</div>
                                <div class="participant-status">Specialized</div>
                            </div>
                            <div class="participant-actions">
                                <button class="action-button add-button">Add</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="add-new-participant">
                    <h2 class="subsection-title">Add New Participant</h2>
                    <form id="new-participant-form">
                        <div class="form-group">
                            <label for="participant-name">Name</label>
                            <input type="text" id="participant-name" placeholder="Enter participant name" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="participant-email">Email</label>
                            <input type="email" id="participant-email" placeholder="Enter participant email" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="participant-role">Role</label>
                            <select id="participant-role">
                                <option value="viewer">Viewer</option>
                                <option value="contributor">Contributor</option>
                                <option value="moderator">Moderator</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="participant-avatar">Avatar (Optional)</label>
                            <div class="avatar-upload">
                                <div class="avatar-preview">
                                    <div id="avatar-preview-image"></div>
                                </div>
                                <label for="avatar-upload-input" class="avatar-upload-label">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
                                    Upload
                                </label>
                                <input type="file" id="avatar-upload-input" accept="image/*" style="display: none;">
                            </div>
                        </div>
                        
                        <button type="submit" class="submit-button">Add Participant</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="js/theme-switcher.js"></script>
    <script src="js/background-effects.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize theme switcher
            initThemeSwitcher();
            
            // Create background effects
            createNeuralNetwork();
            createParticles();
            createWaves();
            
            // Initialize participant management
            initParticipantManagement();
            
            // Initialize avatar upload preview
            initAvatarUpload();
        });
        
        // Theme switcher functionality
        function initThemeSwitcher() {
            const savedTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
            setTheme(savedTheme);
            
            const themeSwitcher = document.querySelector('.theme-switcher');
            const themeButton = document.querySelector('.theme-switcher-button');
            const themeOptions = document.querySelectorAll('.theme-option');
            
            // Toggle dropdown
            themeButton.addEventListener('click', function() {
                themeSwitcher.classList.toggle('active');
            });
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                if (!themeSwitcher.contains(event.target)) {
                    themeSwitcher.classList.remove('active');
                }
            });
            
            // Theme selection
            themeOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    setTheme(theme);
                    themeSwitcher.classList.remove('active');
                });
            });
        }
        
        function setTheme(theme) {
            // Create transition overlay
            const overlay = document.createElement('div');
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.backgroundColor = theme === 'kotor' ? '#00BFFF' : 
                                           theme === 'jedi' ? '#00D4FF' : '#0078D4';
            overlay.style.zIndex = '9999';
            overlay.style.transformOrigin = 'left';
            overlay.style.transform = 'scaleX(0)';
            overlay.style.opacity = '0';
            overlay.style.pointerEvents = 'none';
            document.body.appendChild(overlay);
            
            // Animate the overlay
            overlay.animate([
                { transform: 'scaleX(0)', opacity: 0.3 },
                { transform: 'scaleX(1)', opacity: 0.3 },
                { transform: 'scaleX(1)', opacity: 0 }
            ], {
                duration: 500,
                easing: 'ease-in-out'
            }).onfinish = function() {
                overlay.remove();
            };
            
            // Remove all theme classes
            document.body.classList.remove('kotor-theme', 'jedi-theme', 'professional-theme');
            
            // Add selected theme class
            document.body.classList.add(`${theme}-theme`);
            
            // Update current theme text
            document.querySelector('.current-theme').textContent = 
                theme === 'kotor' ? 'KOTOR' : 
                theme === 'jedi' ? 'Jedi: Survivor' : 
                'Professional';
            
            // Save to localStorage
            localStorage.setItem('pdtAiTheme', theme);
            
            // Update UI elements based on theme
            updateUIForTheme(theme);
            
            // Recreate background effects with theme-specific styling
            createParticles();
            updateNeuralNetworkColors(theme);
            updateWaveColors(theme);
        }
        
        function updateUIForTheme(theme) {
            // Update buttons
            const buttons = document.querySelectorAll('.action-button, .submit-button, .search-button');
            buttons.forEach(button => {
                if (theme === 'kotor') {
                    button.style.border = '1px solid var(--kotor-accent)';
                } else if (theme === 'jedi') {
                    button.style.border = '1px solid var(--jedi-accent)';
                } else {
                    button.style.border = '1px solid var(--prof-accent)';
                }
            });
            
            // Update participant items
            const participantItems = document.querySelectorAll('.participant-item');
            participantItems.forEach(item => {
                if (theme === 'kotor') {
                    item.style.borderLeft = '3px solid var(--kotor-accent)';
                } else if (theme === 'jedi') {
                    item.style.borderLeft = '3px solid var(--jedi-accent)';
                } else {
                    item.style.borderLeft = '3px solid var(--prof-accent)';
                }
            });
            
            // Update AI avatars
            const aiAvatars = document.querySelectorAll('.ai-avatar');
            aiAvatars.forEach(avatar => {
                if (theme === 'kotor') {
                    avatar.style.backgroundColor = 'rgba(var(--kotor-accent-rgb), 0.2)';
                    avatar.style.border = '2px solid var(--kotor-accent)';
                } else if (theme === 'jedi') {
                    avatar.style.backgroundColor = 'rgba(var(--jedi-accent-rgb), 0.2)';
                    avatar.style.border = '2px solid var(--jedi-accent)';
                } else {
                    avatar.style.backgroundColor = 'rgba(var(--prof-accent-rgb), 0.2)';
                    avatar.style.border = '2px solid var(--prof-accent)';
                }
            });
            
            // Update form elements
            const formInputs = document.querySelectorAll('input, select');
            formInputs.forEach(input => {
                if (theme === 'kotor') {
                    input.style.borderColor = 'rgba(var(--kotor-accent-rgb), 0.3)';
                } else if (theme === 'jedi') {
                    input.style.borderColor = 'rgba(var(--jedi-accent-rgb), 0.3)';
                } else {
                    input.style.borderColor = 'rgba(var(--prof-accent-rgb), 0.3)';
                }
            });
            
            // Update back link and theme switcher button styling
            const backLink = document.querySelector('.back-link');
            const themeButton = document.querySelector('.theme-switcher-button');
            const themeDropdown = document.querySelector('.theme-switcher-dropdown');
            
            if (theme === 'kotor') {
                backLink.style.border = '1px solid var(--kotor-accent)';
                themeButton.style.border = '1px solid var(--kotor-accent)';
                themeDropdown.style.border = '1px solid var(--kotor-accent)';
            } else if (theme === 'jedi') {
                backLink.style.border = '1px solid var(--jedi-accent)';
                themeButton.style.border = '1px solid var(--jedi-accent)';
                themeDropdown.style.border = '1px solid var(--jedi-accent)';
            } else {
                backLink.style.border = '1px solid var(--prof-accent)';
                themeButton.style.border = '1px solid var(--prof-accent)';
                themeDropdown.style.border = '1px solid var(--prof-accent)';
            }
        }
        
        // Create neural network nodes and connections
        function createNeuralNetwork() {
            const nodesContainer = document.getElementById('neural-nodes');
            nodesContainer.innerHTML = '';
            const nodeCount = 13;
            const nodes = [];
            
            // Create nodes
            for (let i = 0; i < nodeCount; i++) {
                const node = document.createElement('div');
                node.className = 'neural-node';
                
                // Random position
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                node.style.left = `${x}%`;
                node.style.top = `${y}%`;
                
                nodes.push({
                    element: node,
                    x: x,
                    y: y
                });
                
                nodesContainer.appendChild(node);
            }
            
            // Create connections between nodes
            for (let i = 0; i < nodeCount; i++) {
                const sourceNode = nodes[i];
                
                // Connect to 1-2 other nodes
                const connectionCount = Math.floor(Math.random() * 2) + 1;
                
                for (let j = 0; j < connectionCount; j++) {
                    // Select a random target node
                    const targetIndex = Math.floor(Math.random() * nodeCount);
                    if (targetIndex !== i) {
                        const targetNode = nodes[targetIndex];
                        
                        const connection = document.createElement('div');
                        connection.className = 'neural-connection';
                        
                        // Position at source node
                        connection.style.left = `${sourceNode.x}%`;
                        connection.style.top = `${sourceNode.y}%`;
                        
                        // Calculate length and angle
                        const dx = targetNode.x - sourceNode.x;
                        const dy = targetNode.y - sourceNode.y;
                        const length = Math.sqrt(dx * dx + dy * dy);
                        const angle = Math.atan2(dy, dx) * 180 / Math.PI;
                        
                        // Set width (length) and rotation
                        connection.style.width = `${length}%`;
                        connection.style.transform = `rotate(${angle}deg)`;
                        
                        nodesContainer.appendChild(connection);
                    }
                }
            }
            
            // Update colors based on current theme
            const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
            updateNeuralNetworkColors(currentTheme);
        }
        
        // Update neural network colors based on theme
        function updateNeuralNetworkColors(theme) {
            const nodes = document.querySelectorAll('.neural-node');
            const connections = document.querySelectorAll('.neural-connection');
            
            let nodeColor, connectionColor, nodeShadow;
            
            if (theme === 'kotor') {
                nodeColor = 'rgba(var(--kotor-accent-rgb, 0, 191, 255), 0.5)';
                connectionColor = 'rgba(var(--kotor-accent-rgb, 0, 191, 255), 0.2)';
                nodeShadow = '0 0 4px rgba(var(--kotor-accent-rgb, 0, 191, 255), 0.3)';
            } else if (theme === 'jedi') {
                nodeColor = 'rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.5)';
                connectionColor = 'rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.2)';
                nodeShadow = '0 0 4px rgba(var(--jedi-accent-rgb, 0, 212, 255), 0.3)';
            } else {
                nodeColor = 'rgba(var(--prof-accent-rgb, 0, 120, 212), 0.5)';
                connectionColor = 'rgba(var(--prof-accent-rgb, 0, 120, 212), 0.2)';
                nodeShadow = '0 0 4px rgba(var(--prof-accent-rgb, 0, 120, 212), 0.3)';
            }
            
            nodes.forEach(node => {
                node.style.backgroundColor = nodeColor;
                node.style.boxShadow = nodeShadow;
            });
            
            connections.forEach(connection => {
                connection.style.backgroundColor = connectionColor;
            });
        }
        
        // Create particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            particlesContainer.innerHTML = '';
            
            // Determine particle count and style based on theme
            let particleCount, particleColor, particleOpacity, particleSize, particleGlow;
            
            // Get current theme
            const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
            
            if (currentTheme === 'kotor') {
                particleCount = 15; // Reduced for performance
                particleColor = '#00BFFF';
                particleOpacity = 0.45;
                particleSize = 4;
                particleGlow = '0 0 8px #00BFFF';
            } else if (currentTheme === 'jedi') {
                particleCount = 15; // Reduced for performance
                particleColor = '#00D4FF';
                particleOpacity = 0.35;
                particleSize = 3.5;
                particleGlow = '0 0 7px #00D4FF';
            } else if (currentTheme === 'professional') {
                particleCount = 12; // Reduced for performance
                particleColor = '#0078D4';
                particleOpacity = 0.28;
                particleSize = 2.5;
                particleGlow = '0 0 5px #0078D4';
            }
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                // Apply theme-specific styling
                particle.style.backgroundColor = particleColor;
                particle.style.opacity = particleOpacity;
                particle.style.width = `${particleSize}px`;
                particle.style.height = `${particleSize}px`;
                particle.style.boxShadow = particleGlow;
                
                // Random position
                const x = Math.random() * 100;
                const y = Math.random() * 100;
                particle.style.left = `${x}%`;
                particle.style.top = `${y}%`;
                
                // Random drift direction and speed
                const xDrift = (Math.random() - 0.5) * 400;
                const yDrift = (Math.random() - 0.5) * 400;
                particle.style.setProperty('--x-drift', `${xDrift}px`);
                particle.style.setProperty('--y-drift', `${yDrift}px`);
                
                // Random animation duration
                const duration = 2 + Math.random() * 5;
                particle.style.setProperty('--drift-duration', `${duration}s`);
                
                // Random delay
                const delay = Math.random() * 5;
                particle.style.animationDelay = `${delay}s`;
                
                particlesContainer.appendChild(particle);
            }
        }
        
        // Create waves
        function createWaves() {
            const wavesContainer = document.getElementById('waves-container');
            wavesContainer.innerHTML = '';
            
            // Create 3 wave layers
            for (let i = 0; i < 3; i++) {
                const wave = document.createElement('div');
                wave.className = `wave wave-${i+1}`;
                wavesContainer.appendChild(wave);
            }
            
            // Update wave colors based on theme
            const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
            updateWaveColors(currentTheme);
        }
        
        // Update wave colors based on theme
        function updateWaveColors(theme) {
            const waves = document.querySelectorAll('.wave');
            let waveColor;
            
            if (theme === 'kotor') {
                waveColor = 'rgba(var(--kotor-accent-rgb, 0, 191, 255), ';
            } else if (theme === 'jedi') {
                waveColor = 'rgba(var(--jedi-accent-rgb, 0, 212, 255), ';
            } else {
                waveColor = 'rgba(var(--prof-accent-rgb, 0, 120, 212), ';
            }
            
            waves.forEach((wave, index) => {
                const opacity = 0.09 - (index * 0.015);
                wave.style.background = `${waveColor}${opacity})`;
            });
        }
        
        // Initialize participant management functionality
        function initParticipantManagement() {
            // Add event listeners to "Add" buttons
            const addButtons = document.querySelectorAll('.add-button');
            addButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const participantItem = this.closest('.participant-item');
                    const participantName = participantItem.querySelector('.participant-name').textContent;
                    const participantAvatar = participantItem.querySelector('.participant-avatar').innerHTML;
                    
                    // Add to current participants
                    addToCurrentParticipants(participantName, participantAvatar);
                    
                    // Remove from available participants
                    participantItem.classList.add('fade-out');
                    setTimeout(() => {
                        participantItem.remove();
                    }, 300);
                    
                    // Show notification
                    showNotification(`${participantName} added to chat`);
                });
            });
            
            // Initialize search functionality
            const searchInput = document.getElementById('participant-search');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const participantItems = document.querySelectorAll('.available-list .participant-item');
                
                participantItems.forEach(item => {
                    const name = item.querySelector('.participant-name').textContent.toLowerCase();
                    if (name.includes(searchTerm)) {
                        item.style.display = '';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
            
            // Initialize form submission
            const newParticipantForm = document.getElementById('new-participant-form');
            newParticipantForm.addEventListener('submit', function(event) {
                event.preventDefault();
                
                const name = document.getElementById('participant-name').value;
                const email = document.getElementById('participant-email').value;
                const role = document.getElementById('participant-role').value;
                
                // Create avatar based on name initials if no custom avatar
                let avatarHtml = '';
                const previewImage = document.getElementById('avatar-preview-image');
                
                if (previewImage.style.backgroundImage) {
                    // Use uploaded avatar
                    avatarHtml = `<div style="width: 100%; height: 100%; border-radius: 50%; background-image: ${previewImage.style.backgroundImage}; background-size: cover; background-position: center;"></div>`;
                } else {
                    // Create avatar with initials
                    const initials = name.split(' ').map(n => n[0]).join('').toUpperCase();
                    avatarHtml = `<img src="https://via.placeholder.com/40?text=${initials}" alt="${name} Avatar">`;
                }
                
                // Add to available participants
                addToAvailableParticipants(name, avatarHtml, role);
                
                // Reset form
                newParticipantForm.reset();
                previewImage.style.backgroundImage = '';
                
                // Show notification
                showNotification(`${name} created and ready to add`);
            });
        }
        
        // Add participant to current participants list
        function addToCurrentParticipants(name, avatarHtml) {
            const currentList = document.querySelector('.current-participants .participants-list');
            
            const newItem = document.createElement('div');
            newItem.className = 'participant-item fade-in';
            
            newItem.innerHTML = `
                <div class="participant-avatar">
                    ${avatarHtml}
                </div>
                <div class="participant-info">
                    <div class="participant-name">${name}</div>
                    <div class="participant-status">Active</div>
                </div>
                <div class="participant-actions">
                    <button class="action-button remove-button">Remove</button>
                </div>
            `;
            
            currentList.appendChild(newItem);
            
            // Add event listener to remove button
            const removeButton = newItem.querySelector('.remove-button');
            removeButton.addEventListener('click', function() {
                newItem.classList.add('fade-out');
                setTimeout(() => {
                    newItem.remove();
                    showNotification(`${name} removed from chat`);
                }, 300);
            });
            
            // Apply theme-specific styling
            const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
            if (currentTheme === 'kotor') {
                newItem.style.borderLeft = '3px solid var(--kotor-accent)';
                removeButton.style.border = '1px solid var(--kotor-accent)';
            } else if (currentTheme === 'jedi') {
                newItem.style.borderLeft = '3px solid var(--jedi-accent)';
                removeButton.style.border = '1px solid var(--jedi-accent)';
            } else {
                newItem.style.borderLeft = '3px solid var(--prof-accent)';
                removeButton.style.border = '1px solid var(--prof-accent)';
            }
        }
        
        // Add participant to available participants list
        function addToAvailableParticipants(name, avatarHtml, role) {
            const availableList = document.querySelector('.available-participants .participants-list');
            
            const newItem = document.createElement('div');
            newItem.className = 'participant-item fade-in';
            
            const roleText = role === 'viewer' ? 'Viewer' : 
                            role === 'contributor' ? 'Contributor' : 'Moderator';
            
            newItem.innerHTML = `
                <div class="participant-avatar">
                    ${avatarHtml}
                </div>
                <div class="participant-info">
                    <div class="participant-name">${name}</div>
                    <div class="participant-status">${roleText}</div>
                </div>
                <div class="participant-actions">
                    <button class="action-button add-button">Add</button>
                </div>
            `;
            
            availableList.appendChild(newItem);
            
            // Add event listener to add button
            const addButton = newItem.querySelector('.add-button');
            addButton.addEventListener('click', function() {
                addToCurrentParticipants(name, avatarHtml);
                newItem.classList.add('fade-out');
                setTimeout(() => {
                    newItem.remove();
                }, 300);
                showNotification(`${name} added to chat`);
            });
            
            // Apply theme-specific styling
            const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
            if (currentTheme === 'kotor') {
                newItem.style.borderLeft = '3px solid var(--kotor-accent)';
                addButton.style.border = '1px solid var(--kotor-accent)';
            } else if (currentTheme === 'jedi') {
                newItem.style.borderLeft = '3px solid var(--jedi-accent)';
                addButton.style.border = '1px solid var(--jedi-accent)';
            } else {
                newItem.style.borderLeft = '3px solid var(--prof-accent)';
                addButton.style.border = '1px solid var(--prof-accent)';
            }
        }
        
        // Initialize avatar upload preview
        function initAvatarUpload() {
            const avatarInput = document.getElementById('avatar-upload-input');
            const previewImage = document.getElementById('avatar-preview-image');
            
            avatarInput.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        previewImage.style.backgroundImage = `url('${e.target.result}')`;
                        previewImage.style.backgroundSize = 'cover';
                        previewImage.style.backgroundPosition = 'center';
                    };
                    
                    reader.readAsDataURL(file);
                }
            });
        }
        
        // Show notification
        function showNotification(message) {
            // Check if notification container exists
            let notificationContainer = document.querySelector('.notification-container');
            
            if (!notificationContainer) {
                // Create notification container
                notificationContainer = document.createElement('div');
                notificationContainer.className = 'notification-container';
                document.body.appendChild(notificationContainer);
            }
            
            // Create notification
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            // Apply theme-specific styling
            const currentTheme = localStorage.getItem('pdtAiTheme') || 'jedi';
            if (currentTheme === 'kotor') {
                notification.style.borderLeft = '3px solid var(--kotor-accent)';
                notification.style.backgroundColor = 'rgba(var(--kotor-accent-rgb), 0.1)';
            } else if (currentTheme === 'jedi') {
                notification.style.borderLeft = '3px solid var(--jedi-accent)';
                notification.style.backgroundColor = 'rgba(var(--jedi-accent-rgb), 0.1)';
            } else {
                notification.style.borderLeft = '3px solid var(--prof-accent)';
                notification.style.backgroundColor = 'rgba(var(--prof-accent-rgb), 0.1)';
            }
            
            notificationContainer.appendChild(notification);
            
            // Remove notification after 3 seconds
            setTimeout(() => {
                notification.classList.add('fade-out');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
    </script>
</body>
</html> 